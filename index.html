<html>
<head>

  <script src="src/services.js"></script>
  <link rel="stylesheet" href="css/styles.css">

</head>
<body>

<H1>Birthday Calendar</H1>
<P>
  <div class="allBirthdays" id="allBirthdays" style="display: none"></div>
  <button id="toggleButton" class="button" onclick="toggleBirthdays()">View all birthdays</button>
</P>

<h2>Today's Birthdays:</h2>
<div id="todays">

</div>

<h2>Upcoming Birthdays:</h2>
<div id="upcoming">

</div>

<script LANGUAGE="JavaScript">

  function toggleBirthdays() {
    const element = document.querySelector('.allBirthdays');
    const buttonText = document.getElementById("toggleButton").innerHTML;
    const style = element.style.display;
    document.getElementById("allBirthdays").style.display = (style == "none" ? "block" : "none");
    document.getElementById("toggleButton").innerHTML = (buttonText == "View all birthdays" ? "Hide all birthdays" : "View all birthdays");
  }

  function refresh() {
    let allDays = getAllBirthdays();
    document.getElementById("allBirthdays").innerHTML = "";
    allDays.forEach(birthday => {
      let age = calculateAge(birthday.birthday);
      let deleteButton = "deleteBirthday({name: '" + birthday.name + "', birthday: '" + birthday.birthday + "'})";
      document.getElementById("allBirthdays").innerHTML += '<p><a id="deleteLink" title="Delete birthday" href="#" onclick="' + deleteButton + '; refresh(); return false;" class="delete">Delete</a>'
                                                        + birthday.name + " will be " + age + " in " +  calculateDays(birthday.birthday) + "</p>";
    });

    let items = getTodaysBirthdays();
    document.getElementById("todays").innerHTML = "No birthdays today :-(";
    items.forEach(birthday => {
      let age = calculateAge(birthday.birthday);
      document.getElementById("todays").innerHTML = "<p>Happy Birthday " + birthday.name + ", " + age + " today!! </p>"
    });

    let next = getBirthdaysInNextTwoWeeks();
    document.getElementById("upcoming").innerHTML = "No birthdays coming up :-(";
    next.forEach(birthday => {
      let age = calculateAge(birthday.birthday);
      document.getElementById("upcoming").innerHTML = "<p>" + birthday.name + " will be " + age + " in " + calculateDays(birthday.birthday) + " </p>"
    });
  }

  refresh();

</script>

</body>
</html>
